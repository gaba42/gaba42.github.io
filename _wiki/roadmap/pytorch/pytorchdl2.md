---
layout  : wiki
title   : 차근차근 실습하며 배우는 파이토치 딥러닝 프로그래밍
summary : 
date    : 2023-10-03 20:26:55 +0900
updated : 2023-10-03 22:16:18 +0900
tag     : pytorch
resource: D7/ADBA2D-4876-4AE1-8E57-66350B2FBDF5
toc     : true
public  : true
parent  : [[/roadmap/pytorch]]
latex   : false
---
* TOC
{:toc}

## 책을 다 읽고 난 뒤 목적
- 이미지 분류 모델 실습
- 나오는 코드의 모든 해으이 의미 이해 및 필요에 따라 수정까지 할 수 있을 것

## 자료
- [책 깃허브](https://github.com/wikibook/pytorchdl2/blob/master/notebooks.md)
- 딥러닝을 위한 수학

# 1장. 딥러닝에 꼭 필요한 파이썬의 개념
```python
# y가 동시에 변하면 안 되는 경우, numpy의 copy 함수를 사용한다
x = np.array([5, 6, 8])
y = x.copy()

# x의 특정 요소 값이 변해도, y에는 영향이 없음
x[1] = -1
print(x)  # [5, -1, 9]
print(y)  # [5, 6, 8]
```

## 1.3 합성 함수
- 수학에서의 합성 함수: 여러 개의 함수를 조합한 함수  
- 딥러닝의 예측 알고리즘: **막대한 파라미터를 가진 복잡한 합성 함수**  

$$ f(x) = 2x^2 + 2 $$를 함수로 정의한다.  
  

```python
# 세 가지 기본 함수 정의

def f1(x):
    return(x**2)

def f2(x):
    return(x * 2)

def f3(x):
    return(x+2)
    
# 합성 함수 만들기
x1 = f1(x)
x2 = f2(x1)
y = f3(x2)
```


여기서 포인트는 
- 함수 $f_1$의 출력인 $x_1$이 그대로 다음 함수 $f_2$의 입력값이 되고, 
- $f_2$의 출력 $x_2$도 그대로 $f_3$으로 입력된다는 점이다

코드에서 이와 같은 구현 패턴을 발견하게 된다면 '이 부분에서 합성 함수를 사용하고 있구나'하고 되새겨 주길 바란다.


# 2장 파이토치의 기본 기능
- 파이토치의 최대 특징: **자동 미분 기능**  
- 파이토치에서 연상 대상 데이터는 모두 '텐서(tensor)'라고 하는 파이토치 고유의 형식으로 되어 있어야 한다.

- 계수(rank)
- 0계 텐서 = 스칼라
- 1계 텐서 = 벡터
- 2계 텐서 = 행렬(matrix)

파이토치 대부분의 계산은 부동소수점 수치형(dtype=float32)을 사용한다. 그러나 한 가지 예외가 존재하는데
- 다중 분류에서 사용하는 손실함수인 nn.CrossEntropyLoss와 nn.NLLLoss 손실함수를 호출할 때, 두번째 인수로 정수 타입을 지정해야 한다.
    - long 함수를 적용하면 dtype으로 torch.int64를 갖는 정수형 텐서가 정의된다.

### view 함수
- 넘파이에서 reshape 함수를 사용해 넘파이 변수의 계수 변환이 가능하다.
- 텐서의 경우, 같은 역할을 하는 함수로 view 함수가 있다.
```python
# 2계화
# 남은 자리에 -1을 지정하면 이 수를 자동으로 조정함
# r3 = 3계 텐서 
r6 = r3.view(2, -1)

# shape 확인
print(r6.shape)

# 값 확인
print(r6.data)
```


